{
  "url": "https://tradingview.github.io/lightweight-charts/docs/plugins/canvas-rendering-target",
  "title": "Canvas Rendering Target",
  "content": "The renderer functions used within the plugins (both Custom Series, and Drawing Primitives) are provided with a CanvasRenderingTarget2D interface on which the drawing logic (using the Browser's 2D Canvas API) should be executed. CanvasRenderingTarget2D is provided by the Fancy Canvas library.\n\nThe typescript definitions can be viewed here: fancy-canvas on npmjs.com and specifically the definition for CanvasRenderingTarget2D can be viewed here: canvas-rendering-target.d.ts\n\nand specifically the definition for CanvasRenderingTarget2D can be viewed here: canvas-rendering-target.d.ts\n\nCanvasRenderingTarget2D provides two rendering scope which you can use:\n\nBitmap sizing represents the actual physical pixels on the device's screen, while the media size represents the size of a pixel according to the operating system (and browser) which is generally an integer representing the ratio of actual physical pixels are used to render a media pixel. This integer ratio is referred to as the device pixel ratio.\n\nUsing the bitmap sizing allows for more control over the drawn image to ensure that the graphics are crisp and pixel perfect, however this generally means that the code will contain a lot multiplication of coordinates by the pixel ratio. In cases where you don't need to draw using the bitmap sizing then it is easier to use media sizing as you don't need to worry about the devices pixel ratio.\n\nuseBitmapCoordinateSpace can be used to if you would like draw using the actual devices pixels as the coordinate sizing. The provided scope (of type BitmapCoordinatesRenderingScope) contains readonly values for the following:\n\nuseMediaCoordinateSpace can be used to if you would like draw using the media dimensions as the coordinate sizing. The provided scope (of type MediaCoordinatesRenderingScope) contains readonly values for the following:\n\nIt is recommended that rendering functions should save and restore the canvas context before and after all the rendering logic to ensure that the canvas state is the same as when the renderer function was evoked. To handle the case when an error in the code might prevent the restore function from being evoked, you should use the try - finally code block to ensure that the context is correctly restored in all cases.\n\nNote that useBitmapCoordinateSpace and useMediaCoordinateSpace will automatically save and restore the canvas context for the logic defined within them. This tip for your additional rendering functions within the use*CoordinateSpace.",
  "headings": [
    {
      "level": "h1",
      "text": "Canvas Rendering Target",
      "id": ""
    },
    {
      "level": "h2",
      "text": "Using CanvasRenderingTarget2D​",
      "id": "using-canvasrenderingtarget2d"
    },
    {
      "level": "h2",
      "text": "Difference between Bitmap and Media​",
      "id": "difference-between-bitmap-and-media"
    },
    {
      "level": "h3",
      "text": "Bitmap Coordinate Space​",
      "id": "bitmap-coordinate-space"
    },
    {
      "level": "h4",
      "text": "Bitmap Coordinate Space Usage​",
      "id": "bitmap-coordinate-space-usage"
    },
    {
      "level": "h3",
      "text": "Media Coordinate Space​",
      "id": "media-coordinate-space"
    },
    {
      "level": "h4",
      "text": "Media Coordinate Space Usage​",
      "id": "media-coordinate-space-usage"
    },
    {
      "level": "h2",
      "text": "General Tips​",
      "id": "general-tips"
    }
  ],
  "code_samples": [
    {
      "code": "// target is an instance of CanvasRenderingTarget2Dtarget.useBitmapCoordinateSpace(scope => {    // scope is an instance of BitmapCoordinatesRenderingScope    // example of drawing a filled rectangle which fills the canvas    scope.context.beginPath();    scope.context.rect(0, 0, scope.bitmapSize.width, scope.bitmapSize.height);    scope.context.fillStyle = 'rgba(100, 200, 50, 0.5)';    scope.context.fill();});",
      "language": "javascript"
    },
    {
      "code": "// target is an instance of CanvasRenderingTarget2Dtarget.useMediaCoordinateSpace(scope => {    // scope is an instance of BitmapCoordinatesRenderingScope    // example of drawing a filled rectangle which fills the canvas    scope.context.beginPath();    scope.context.rect(0, 0, scope.mediaSize.width, scope.mediaSize.height);    scope.context.fillStyle = 'rgba(100, 200, 50, 0.5)';    scope.context.fill();});",
      "language": "javascript"
    },
    {
      "code": "function myRenderingFunction(scope) {    const ctx = scope.context;    // save the current state of the context to the stack    ctx.save();    try {        // example code        scope.context.beginPath();        scope.context.rect(0, 0, scope.mediaSize.width, scope.mediaSize.height);        scope.context.fillStyle = 'rgba(100, 200, 50, 0.5)';        scope.context.fill();    } finally {        // restore the saved context from the stack        ctx.restore();    }}target.useMediaCoordinateSpace(scope => {    myRenderingFunction(scope);    myOtherRenderingFunction(scope);    /* ... */});",
      "language": "javascript"
    }
  ],
  "patterns": [],
  "links": [
    "https://tradingview.github.io/lightweight-charts/docs/plugins/canvas-rendering-target",
    "https://tradingview.github.io/lightweight-charts/docs",
    "https://tradingview.github.io/lightweight-charts/docs/api",
    "https://tradingview.github.io/lightweight-charts/docs/4.0",
    "https://tradingview.github.io/lightweight-charts/docs/3.8",
    "https://tradingview.github.io/lightweight-charts/docs/series-types",
    "https://tradingview.github.io/lightweight-charts/docs/chart-types",
    "https://tradingview.github.io/lightweight-charts/docs/price-scale",
    "https://tradingview.github.io/lightweight-charts/docs/time-scale",
    "https://tradingview.github.io/lightweight-charts/docs/panes",
    "https://tradingview.github.io/lightweight-charts/docs/time-zones",
    "https://tradingview.github.io/lightweight-charts/docs/plugins/intro",
    "https://tradingview.github.io/lightweight-charts/docs/plugins/series-primitives",
    "https://tradingview.github.io/lightweight-charts/docs/plugins/pane-primitives",
    "https://tradingview.github.io/lightweight-charts/docs/plugins/custom_series",
    "https://tradingview.github.io/lightweight-charts/docs/plugins/pixel-perfect-rendering",
    "https://tradingview.github.io/lightweight-charts/docs/migrations/from-v2-to-v3",
    "https://tradingview.github.io/lightweight-charts/docs/ios",
    "https://tradingview.github.io/lightweight-charts/docs/android",
    "https://tradingview.github.io/lightweight-charts/docs/release-notes"
  ]
}